var data = {
    categories : [
        {title:"Operations",values: [{id:1,title:"Food & Beverages"},{id:2,title:"IT & Engineering"},{id:3,title:"Facility Management"},{id:4,title:"Asset Management"}]},
        {title:"Guest Facing",values: [{id:5,title:"Guest Management"},{id:6,title:"Guest Tablet"},{id:7,title:"Survey Tool"}]},
        {title:"Back Office",values: [{id:8,title:"Collaboration tools"},{id:9,title:"Talent Acquisition"},{id:10,title:"HR & Staffing"},{id:11,title:"Payroll"}]},
        {title:"Sales & Marketing",values: [{id:12,title:"Sales & Marketing Management"},{id:13,title:"Event Management"},{id:14,title:"Revenue Management"}]}
    ],
    companies: [
        {id:1,title:"Advancya"},
        {id:2,title:"Hotels"},
        {id:3,title:"Expedia"},
        {id:4,title:"Microsoft"},
		{id:5,title:"Agile Engine"},
		{id:6,title:"Paragent"},
		{id:7,title:"Fingent"},
		{id:8,title:"Groove John"},
		{id:9,title:"It Transition"},
		{id:10,title:"Exadel"},
		{id:11,title:"Syberry"},
		{id:12,title:"Mojotech"},
		{id:13,title:"Experion"},
		{id:14,title:"Orases"},
		{id:15,title:"Microsoft"}
		
		
		
    ],
    products:[
        {id:1,title:'Office 365',categoryid:1,companyid:15,subscritionPeriod:'1 year',price:11,currency:'QAR',description:'Dynamics Facility is a specialized business software solution for facility management companies. Based on Microsoft Dynamics technology, Dynamics Facility covers the business process related to administrative management of buildings, floors, locations, adjacent areas, as well as their corresponding building costs, expenses and receivables, documents (such as contracts and annexes).',tableofContentTitle:'All you need for your facility management business 1!',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '},{iconClass:'fa fa-check',content:'Locations '}]},
        {id:2,title:'Skype',categoryid:1,companyid:15,subscritionPeriod:'1 year',price:11,currency:'QAR',description:'Dynamics Facility is a specialized business software solution for facility management companies. Based on Microsoft Dynamics technology, Dynamics Facility covers the business process related to administrative management of buildings, floors, locations, adjacent areas, as well as their corresponding building costs, expenses and receivables, documents (such as contracts and annexes).',tableofContentTitle:'All you need for your facility management business 1!',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '},{iconClass:'fa fa-check',content:'Locations '}]},
        {id:3,title:'Exhange',categoryid:1,companyid:15,subscritionPeriod:'1 year',price:11,currency:'QAR',description:'Dynamics Facility is a specialized business software solution for facility management companies. Based on Microsoft Dynamics technology, Dynamics Facility covers the business process related to administrative management of buildings, floors, locations, adjacent areas, as well as their corresponding building costs, expenses and receivables, documents (such as contracts and annexes).',tableofContentTitle:'All you need for your facility management business 1!',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '},{iconClass:'fa fa-check',content:'Locations '}]},
        {id:4,title:'SharePoint',categoryid:1,companyid:15,subscritionPeriod:'1 year',price:11,currency:'QAR',description:'Dynamics Facility is a specialized business software solution for facility management companies. Based on Microsoft Dynamics technology, Dynamics Facility covers the business process related to administrative management of buildings, floors, locations, adjacent areas, as well as their corresponding building costs, expenses and receivables, documents (such as contracts and annexes).',tableofContentTitle:'All you need for your facility management business 1!',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '},{iconClass:'fa fa-check',content:'Locations '}]},
       {id:5,title:'Ax Dyanmicx',categoryid:1,companyid:1,subscritionPeriod:'1 year',price:11,currency:'QAR',description:'Dynamics Facility is a specialized business software solution for facility management companies. Based on Microsoft Dynamics technology, Dynamics Facility covers the business process related to administrative management of buildings, floors, locations, adjacent areas, as well as their corresponding building costs, expenses and receivables, documents (such as contracts and annexes).',tableofContentTitle:'All you need for your facility management business 1!',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '},{iconClass:'fa fa-check',content:'Locations '}]},
       
		{id:6,title:'Ajaxswing',categoryid:2,companyid:5,subscritionPeriod:'1 year',price:30,currency:'QAR',description:'AjaxSwing is a web deployment platform for Java Swing applications. It allows companies that built Java desktop applications to run them as web applications. AjaxSwing is a web deployment platform for Java Swing applications. It allows companies that built Java desktop applications to run them as web applications.It allows companies that built Java desktop applications to run them as web applications.',tableofContentTitle:'All you need for your facility management',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '},{iconClass:'fa fa-check',content:'Locations '}]},
		{id:7,title:'Screenster',categoryid:2,companyid:5,subscritionPeriod:'1 year',price:20,currency:'QAR',description:'Screenster can intelligently detect  Screenster can intelligently detect visual and content changes. It has sophisticated algorithms that compare run results to the baseline and find new, deleted and changed content.It allows companies that built Java desktop applications to run them as web applications.It allows companies that built Java desktop applications to run them as web applications.',tableofContentTitle:'All you need for your facility management business 1!',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '},{iconClass:'fa fa-check',content:'Locations '}]},
		
		{id:8,title:'jStrobe',categoryid:1,companyid:2,subscritionPeriod:'2 year',price:12,currency:'QAR',description:'Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis,  pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.',tableofContentTitle:'All you need for your facility management business! 2',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Buildings Floors'}]},
		 
		 {id:9,title:'LanSchool',categoryid:3,companyid:1,subscritionPeriod:'1.5 year',price:15,currency:'QAR',description:'Screenster can intelligently detect visual and content changes. It has sophisticated algorithms that compare run results to the baseline and find new, deleted and changed content.It allows companies that built Java desktop applications to run them as web applications.It allows companies that built Java desktop applications to run them as web applications.',tableofContentTitle:'All you need for your facility management business 3!',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Locations '},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '}]},
		{id:10,title:'Logger Pro',categoryid:1,companyid:1,subscritionPeriod:'2 year',price:18,currency:'QAR',description:'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industrys standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.',tableofContentTitle:'All you need for your facility management business! 4',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Annexes '}]},
        {id:11,title:'Mathematica 12',categoryid:1,companyid:2,subscritionPeriod:'4 year',price:20,currency:'QAR',description:'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industrys standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.',tableofContentTitle:'All you need for your facility management business! 5',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contracts References'}]},
		{id:12,title:'MatLab',categoryid:3,companyid:1,subscritionPeriod:'5 year',price:30,currency:'QAR',description:'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industrys standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.',tableofContentTitle:'All you need for your facility management business! 6',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Intranet and team sites with SharePoint'}]},
		{id:8,title:'MatterControl',categoryid:1,companyid:2,subscritionPeriod:'2 year',price:12,currency:'QAR',description:'Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis,  pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.',tableofContentTitle:'All you need for your facility management business! 2',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Buildings Floors'}]},
		 
		 {id:9,title:'NI LabView',categoryid:3,companyid:9,subscritionPeriod:'1.5 year',price:15,currency:'QAR',description:'Screenster can intelligently detect visual and content changes. It has sophisticated algorithms that compare run results to the baseline and find new, deleted and changed content.It allows companies that built Java desktop applications to run them as web applications.It allows companies that built Java desktop applications to run them as web applications.',tableofContentTitle:'All you need for your facility management business 3!',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Locations '},{iconClass:'fa fa-window-close',content:'Contacts  '},{iconClass:'fa fa-check',content:'Buildings Floors '}]},
		{id:10,title:'PV F-Chart',categoryid:1,companyid:9,subscritionPeriod:'2 year',price:18,currency:'QAR',description:'Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.',tableofContentTitle:'All you need for your facility management business! 4',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Annexes '}]},
        {id:11,title:'Ultimaker Cura',categoryid:1,companyid:8,subscritionPeriod:'4 year',price:20,currency:'QAR',description:'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industrys standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.',tableofContentTitle:'All you need for your facility management business! 5',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Contracts References'}]},
		{id:12,title:'VRay for 3DS ',categoryid:3,companyid:8,subscritionPeriod:'5 year',price:30,currency:'QAR',description:'Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industrys standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.',tableofContentTitle:'All you need for your facility management business! 6',tableofContentlist:[{iconClass:'fa fa-check',content:'Account'},{iconClass:'fa fa-window-close',content:'Intranet and team sites with SharePoint'}]}
		
		
	
	]
}

var updateCounts = function(){
    $('#tdcategories .categoryClass').each(function(){
        var id = $(this).attr("data-id");
        var count = $("#tdresults div[data-cat='" + id + "'][data-visible='true']").length;
        $(this).find(".count").html(count);
    })

    $('#tdcompanies .companyClass').each(function(){
        var id = $(this).attr("data-id");
        var count = $("#tdresults div[data-com='" + id + "'][data-visible='true']").length;
        $(this).find(".count").html(count);
    })

}

var filterData = function(filter){
    var compFilter = filter.company;
    var subcategoryFilter = filter.subcategory;

    $('#tdresults .productClass').each(function(){
        debugger;
        var hide = false;
        var company = $(this).attr('data-com');
        var subcategory  = $(this).attr('data-cat');
        if(compFilter != undefined && compFilter != null)
        {
            hide = !(compFilter == company);
        }
        if(!hide)
        {
            if(subcategoryFilter != undefined && subcategoryFilter != null)
            {
                hide = !(subcategoryFilter == subcategory);
            }
        }
        if(hide)
        {
            $(this).hide();
            $(this).attr('data-visible','false');
        }
        else
        {
            $(this).show();
            $(this).attr('data-visible','true');
        }
    })

}

var generateFilters = function(){

    var selectedCompany = null;
    var selectedCategory = null;
    if($("#tdcompanies div[data-filter='true']").length == 1)
        selectedCompany = $("#tdcompanies div[data-filter='true']").eq(0).attr('data-id');
    if($("#tdcategories div[data-filter='true']").length == 1)
        selectedCategory = $("#tdcategories div[data-filter='true']").eq(0).attr('data-id');

    filterData({company:selectedCompany,subcategory:selectedCategory});
    
}

var clearFilters = function(type){
    if(type == 'cat')
    {
        $('#tdcategories .categoryClass').each(function(){
            $(this).removeClass('filterSelected');
            $(this).attr('data-filter','false');
        })
    }
    else
    {
        $('#tdcompanies .companyClass').each(function(){
            $(this).removeClass('filterSelected');
            $(this).attr('data-filter','false');
        })
    }
    $('#tdresults .productClass').each(function(){$(this).show()})

}

var toggleFilter = function(element,type){

    var isSelected = $(element).attr('data-filter');

    clearFilters(type);
    
    
    isSelected = isSelected == "true" ? "false" : "true";
    $(element).attr('data-filter',isSelected);
    $(element).addClass(isSelected == "true" ? "filterSelected" : "filterNotSelected");
    $(element).removeClass(isSelected == "true" ? "filterNotSelected" : "filterSelected");

    generateFilters();
}

var GenerateHtml = function(data){
    var source   = document.getElementById("productTemplate").innerHTML;
    var template = Handlebars.compile(source);   
    var html = template(data);
    $("#results").html(html);
    updateCounts();
}

$(document).ready(function(){
    GenerateHtml(data);
})
